---
layout: default
---

{% comment %} navbar removed on post pages {% endcomment %}

<article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting" id="main" role="article" aria-label="Content">

  <!-- The logo is now a direct grid item -->
  <div class="post-logo-left">
    <a href="{{ '/' | relative_url }}">
      <img src="{{ '/assets/images/carruc-eu-logo-inline.png' | relative_url }}" alt="carruc.eu logo inline">
    </a>
  </div>

  <!-- The table of contents is also a direct grid item -->
  <aside class="post-toc-left">
    <nav class="toc" aria-label="Table of contents">
      <div class="toc-title">Table of Contents:</div>
      <ul class="toc-list"></ul>
    </nav>
  </aside>

  <nav class="menu">
    <ul>
      {% for item in site.data.menu %}
          <a href="{{ item.url | relative_url }}">{{ item.title }}</a>
      {% endfor %}
    </ul>
  </nav>

  {% if page.title != "" %}
    <h1 class="post-title p-name" itemprop="name headline">
      {{ page.title }}
    </h1>
  {% endif %}

  <!-- Create a single container for the intro and the body -->
  <div class="article-body-container">
    {% if page.intro %}
      <p class="intro">{{ page.intro }}</p>
    {% endif %}

    <div class="post-content e-content" itemprop="articleBody">
      {{ content }}
    </div>
  </div>

  <div class="post-meta">
    {% if page.author %}
      <div itemprop="author">{{ page.author }}</div>
    {% endif %}
    <time class="post-date dt-published" datetime="{{ page.date | date_to_xmlschema }}" itemprop="datePublished">{{ page.date | date: "%B %-d, %Y" }}</time>
  </div>

  {% if site.disqus.shortname %}
    {% include disqus-comments.html %}
  {% endif %}

</article>

<script>
  (function() {
    // This selector is now corrected to find the content inside the new container.
    var content = document.querySelector('.post .article-body-container .post-content');
    var list = document.querySelector('.post .post-toc-left .toc-list');
    
    // The rest of the script is the same, but it will now work.
    if (!content || !list) return;
  
    var headings = content.querySelectorAll('h1, h2, h3');
    if (!headings.length) return;
  
    function slugify(text){
      return text.toLowerCase().trim().replace(/[^a-z0-9\s-]/g,'').replace(/\s+/g,'-').replace(/-+/g,'-');
    }
  
    headings.forEach(function(h){
      var level = parseInt(h.tagName.substr(1), 10);
      if (level < 1 || level > 3) return;
  
      if (!h.id) {
        h.id = slugify(h.textContent || h.innerText || 'section');
      }
  
      var li = document.createElement('li');
      li.className = 'toc-level-' + level;
      var a = document.createElement('a');
      a.href = '#' + h.id;
      a.textContent = h.textContent || h.innerText || '';
      li.appendChild(a);
      list.appendChild(li);
    });
  })();
  </script>
  